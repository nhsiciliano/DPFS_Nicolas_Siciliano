<!DOCTYPE html>
<html lang="es">
<%- include('../partials/head', { title: 'Editar Producto' , css: 'auth' }) %>

    <body>
        <%- include('../partials/header') %>

            <main class="container auth-container">
                <div class="auth-card" style="max-width: 600px;">
                    <h1>Editar Producto</h1>
                    <p class="auth-subtitle">Modifica los datos del producto</p>

                    <!-- Method override simulation for PUT -->
                    <form action="/products/<%= product.id %>?_method=PUT" method="POST" class="auth-form"
                        enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="name">Nombre del Producto</label>
                            <input type="text" id="name" name="name" value="<%= product.name %>" required>
                        </div>

                        <div class="form-group">
                            <label for="description">Descripción</label>
                            <textarea id="description" name="description" rows="4"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"
                                required><%= product.description %></textarea>
                        </div>

                        <div class="form-group">
                            <label for="category_id">Categoría</label>
                            <select id="category_id" name="category_id"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"
                                required>
                                <% categories.forEach(category=> { %>
                                    <option value="<%= category.id %>" <%=product.category_id==category.id ? 'selected'
                                        : '' %>><%= category.name %>
                                    </option>
                                    <% }) %>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="brand_id">Marca</label>
                            <select id="brand_id" name="brand_id"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"
                                required>
                                <% brands.forEach(brand=> { %>
                                    <option value="<%= brand.id %>" <%=product.brand_id==brand.id ? 'selected' : '' %>>
                                        <%= brand.name %>
                                    </option>
                                    <% }) %>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Colores disponibles:</label>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <% colors.forEach(color=> { %>
                                    <div>
                                        <input type="checkbox" name="colors" value="<%= color.id %>"
                                            id="color_<%= color.id %>" <% if (product.colors && product.colors.some(c=>
                                        c.id == color.id)) { %> checked <% } %> >
                                            <label for="color_<%= color.id %>">
                                                <%= color.name %>
                                            </label>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>

                        <input type="hidden" name="oldImage" value="<%= product.image %>">


                        <div class="form-group">
                            <label for="price">Precio</label>
                            <input type="number" id="price" name="price" value="<%= product.price %>" step="0.01"
                                required>
                        </div>

                        <div class="form-group">
                            <label for="image">Imagen del Producto</label>
                            <input type="file" id="image" name="image" accept="image/*"
                                style="border: none; padding-left: 0;">
                            <small style="display: block; margin-top: 5px; color: #666;">Imagen actual: <%=
                                    product.image %></small>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block">Actualizar Producto</button>
                    </form>
                </div>
            </main>

            <%- include('../partials/footer') %>
    </body>

</html>